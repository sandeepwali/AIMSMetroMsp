----------------------------------------------
-- AIMS Message Queue Channel Message Store --
----------------------------------------------
CREATE SEQUENCE AIMS_MESSAGE_QUEUE_MESSAGE_SEQ START WITH 1 INCREMENT BY 1 NO CYCLE;

CREATE TABLE AIMS_MESSAGE_QUEUE_CHANNEL_MESSAGE (
	MESSAGE_ID character(36) NOT NULL,
	GROUP_KEY character(36) NOT NULL,
	CREATED_DATE BIGINT NOT NULL,
	MESSAGE_PRIORITY INT,
	MESSAGE_SEQUENCE BIGINT NOT NULL DEFAULT nextval('AIMS_MESSAGE_QUEUE_MESSAGE_SEQ'),
	MESSAGE_BYTES bytea,
	REGION character varying(100) NOT NULL,
	constraint AIMS_MESSAGE_QUEUE_CHANNEL_MESSAGE_PK primary key (GROUP_KEY, MESSAGE_ID, REGION)
);

CREATE INDEX AIMS_MESSAGE_QUEUE_CHANNEL_MSG_DATE_IDX ON AIMS_MESSAGE_QUEUE_CHANNEL_MESSAGE USING btree (CREATED_DATE, MESSAGE_SEQUENCE);
CREATE INDEX AIMS_MESSAGE_QUEUE_CHANNEL_MSG_PRIORITY_IDX ON AIMS_MESSAGE_QUEUE_CHANNEL_MESSAGE USING btree (MESSAGE_PRIORITY DESC, CREATED_DATE, MESSAGE_SEQUENCE);

-----------------------------------------------
-- AIMS Contract Queue Channel Message Store --
-----------------------------------------------
CREATE SEQUENCE AIMS_CONTRACT_QUEUE_MESSAGE_SEQ START WITH 1 INCREMENT BY 1 NO CYCLE;

CREATE TABLE AIMS_CONTRACT_QUEUE_CHANNEL_MESSAGE (
	MESSAGE_ID character(36) NOT NULL,
	GROUP_KEY character(36) NOT NULL,
	CREATED_DATE BIGINT NOT NULL,
	MESSAGE_PRIORITY INT,
	MESSAGE_SEQUENCE BIGINT NOT NULL DEFAULT nextval('AIMS_CONTRACT_QUEUE_MESSAGE_SEQ'),
	MESSAGE_BYTES bytea,
	REGION character varying(100) NOT NULL,
	constraint AIMS_CONTRACT_QUEUE_CHANNEL_MESSAGE_PK primary key (GROUP_KEY, MESSAGE_ID, REGION)
);

CREATE INDEX AIMS_CONTRACT_QUEUE_CHANNEL_MSG_DATE_IDX ON AIMS_CONTRACT_QUEUE_CHANNEL_MESSAGE USING btree (CREATED_DATE, MESSAGE_SEQUENCE);
CREATE INDEX AIMS_CONTRACT_QUEUE_CHANNEL_MSG_PRIORITY_IDX ON AIMS_CONTRACT_QUEUE_CHANNEL_MESSAGE USING btree (MESSAGE_PRIORITY DESC, CREATED_DATE, MESSAGE_SEQUENCE);